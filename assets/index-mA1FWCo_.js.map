{"version":3,"file":"index-mA1FWCo_.js","sources":["../../src/components/code-input/index.tsx"],"sourcesContent":["import { forwardRef } from 'react';\nimport { Box, Flex } from 'rebass';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport {\n  CompletionContext,\n  autocompletion,\n  Completion,\n} from '@codemirror/autocomplete';\nimport { loadLanguage } from '@uiw/codemirror-extensions-langs';\nimport { darcula } from '@uiw/codemirror-theme-darcula';\nimport CodeMirror, {\n  Extension,\n  ReactCodeMirrorProps,\n} from '@uiw/react-codemirror';\n\n// Components\nimport { BoxProps } from '../box';\nimport { GetIcon, IconName } from '../icon';\nimport InputInfo from '../input-info';\nimport { Intents } from '../intents';\nimport Label, { LabelProps } from '../label';\nimport Tooltip from '../tooltip';\nimport Labeling from '../typography/labeling';\n\nconst createCompletions =\n  (completions: Completion[]) => (context: CompletionContext) => {\n    const before = context.matchBefore(/\\w+/);\n    // If completion wasn't explicitly started and there\n    // is no word before the cursor, don't open completions.\n    if (!context.explicit && !before) return null;\n    return {\n      from: before ? before.from : context.pos,\n      options: completions,\n      validFor: /^\\w*$/,\n    };\n  };\n\nexport interface CodeInputProps\n  extends Omit<BoxProps, 'children' | 'onChange'> {\n  label?: string;\n  value: string;\n  mode: 'json' | 'javascript' | 'yaml' | 'python' | 'sql';\n  width?: string | number;\n  height?: string;\n  labelAction?: React.ReactNode;\n  optional?: boolean;\n  tooltipInfo?: string;\n  labelProps?: Omit<LabelProps, 'action' | 'text' | 'children'>;\n  onChange: (value: string) => void;\n  readOnly: boolean;\n  info?: string;\n  intent?: Intents;\n  codeMirrorProps?: ReactCodeMirrorProps;\n  completions?: Completion[];\n}\n\nconst CodeInput = forwardRef(\n  ({\n    label = '',\n    value,\n    mode,\n    width = '100%',\n    height = '100%',\n    labelAction,\n    optional,\n    tooltipInfo,\n    labelProps,\n    onChange,\n    readOnly = false,\n    info,\n    intent = 'default',\n    codeMirrorProps,\n    completions,\n    ...props\n  }: CodeInputProps) => {\n    const actions = (labelAction || tooltipInfo || optional) && (\n      <Flex>\n        {labelAction}\n        {optional && (\n          <Labeling ml=\"8px\" bold gray>\n            optional\n          </Labeling>\n        )}\n        {tooltipInfo && (\n          <Tooltip mainText={tooltipInfo}>\n            <GetIcon mt=\"3px\" ml=\"3px\" size=\"xs\" icon={IconName.info_block} />\n          </Tooltip>\n        )}\n      </Flex>\n    );\n\n    return (\n      <Box width={width} tx=\"inputs\" {...props}>\n        <Label\n          action={actions}\n          text={label}\n          width={width}\n          {...labelProps}\n          mb=\"8px\"\n        >\n          <Box\n            sx={{\n              '*': { fontFamily: 'inherit' },\n            }}\n          >\n            <CodeMirror\n              value={value}\n              basicSetup={{\n                autocompletion: false,\n                lineNumbers: true,\n                foldGutter: false,\n              }}\n              extensions={\n                [\n                  loadLanguage(mode)!,\n                  completions\n                    ? autocompletion({\n                        override: [createCompletions(completions)],\n                      })\n                    : false,\n                ].filter(Boolean) as Extension[]\n              }\n              theme={darcula}\n              onChange={onChange}\n              readOnly={readOnly}\n              height={height}\n              {...codeMirrorProps}\n            />\n          </Box>\n        </Label>\n        {info && <InputInfo intent={intent}>{info}</InputInfo>}\n      </Box>\n    );\n  },\n);\n\nexport default CodeInput;\n"],"names":["createCompletions","completions","context","before","CodeInput","forwardRef","label","value","mode","width","height","labelAction","optional","tooltipInfo","labelProps","onChange","readOnly","info","intent","codeMirrorProps","props","actions","jsxs","Flex","jsx","Labeling","Tooltip","GetIcon","IconName","Box","Label","CodeMirror","loadLanguage","autocompletion","darcula","InputInfo"],"mappings":"+aAwBA,MAAAA,EAAAC,GAAAC,GAAA,CAEI,MAAAC,EAAAD,EAAA,YAAA,KAAA,EAGA,MAAA,CAAAA,EAAA,UAAA,CAAAC,EAAkC,KAClC,CAAO,KAAAA,EAAAA,EAAA,KAAAD,EAAA,IACgC,QAAAD,EAC5B,SAAA,OACC,CAEd,EAqBFG,EAAAC,EAAA,WAAkB,CAAA,CACf,MAAAC,EAAA,GACS,MAAAC,EACR,KAAAC,EACA,MAAAC,EAAA,OACQ,OAAAC,EAAA,OACC,YAAAC,EACT,SAAAC,EACA,YAAAC,EACA,WAAAC,EACA,SAAAC,EACA,SAAAC,EAAA,GACW,KAAAC,EACX,OAAAC,EAAA,UACS,gBAAAC,EACT,YAAAlB,EACA,GAAAmB,CACG,IAAA,CAEH,MAAAC,GAAAV,GAAAE,GAAAD,IAAAU,OAAAC,EAAA,CAAA,SAAA,CAEKZ,EAAAC,GAAAY,EAAA,IAAAC,EAAA,CAAA,GAAA,MAAA,KAAA,GAAA,KAAA,GAAA,SAAA,UAAA,CAAA,EAICZ,GAAAW,EAAAA,IAAAE,EAAA,CAAA,SAAAb,EAAA,SAAAW,MAAAG,EAAA,CAAA,GAAA,MAAA,GAAA,MAAA,KAAA,KAAA,KAAAC,EAAA,UAAA,CAAA,EAAA,CAKA,CAAA,CAAA,EAKN,OAAAN,EAAA,KAAAO,EAAA,CAAA,MAAApB,EAAA,GAAA,SAAA,GAAAW,EAAA,SAAA,CAEII,EAAA,IAAAM,EAAC,CAAA,OAAAT,EACS,KAAAf,EACF,MAAAG,EACN,GAAAK,EACI,GAAA,MACD,SAAAU,EAAA,IAEHK,EAAC,CAAA,GAAA,CACK,IAAA,CAAA,WAAA,SAAA,CAC2B,EAC/B,SAAAL,EAAA,IAEAO,EAAC,CAAA,MAAAxB,EACC,WAAA,CACY,eAAA,GACM,YAAA,GACH,WAAA,EACD,EACd,WAAA,CAEEyB,EAAAxB,CAAA,EACmBP,EAAAgC,EAAA,CAEE,SAAA,CAAAjC,EAAAC,CAAA,CAAA,CAC4B,CAAA,EAAA,EAE3C,EAAA,OAAA,OAAA,EACU,MAAAiC,EAEX,SAAAnB,EACP,SAAAC,EACA,OAAAN,EACA,GAAAS,CACI,CAAA,CACN,CAAA,CACF,CAAA,EACFF,GAAAO,EAAA,IAAAW,EAAA,CAAA,OAAAjB,EAAA,SAAAD,EAAA,CAC0C,CAAA,CAAA,CAC5C,CAGN;;;;;;;;"}