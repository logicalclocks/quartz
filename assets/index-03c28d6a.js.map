{"version":3,"file":"index-03c28d6a.js","sources":["../../src/utils/index.ts","../../src/components/code/code.styles.ts","../../src/components/code/index.tsx"],"sourcesContent":["export const copyToClipboard = async (content: string) => {\n  // Navigator clipboard api needs a secure context (https)\n  if (navigator.clipboard && window.isSecureContext) {\n    await navigator.clipboard.writeText(content);\n    return true;\n  }\n  // Use the 'out of viewport hidden text area' trick\n  const textArea = document.createElement('textarea');\n  textArea.value = content;\n\n  // Move textarea out of the viewport so it's not visible\n  textArea.style.position = 'absolute';\n  textArea.style.left = '-999999px';\n\n  document.body.prepend(textArea);\n  textArea.select();\n\n  try {\n    document.execCommand('copy');\n    return true;\n  } catch (error) {\n    console.error(error);\n    return false;\n  } finally {\n    textArea.remove();\n  }\n};\n\nexport const saveToFile = (\n  title?: React.ReactElement | string,\n  content?: string,\n): void => {\n  if (title) {\n    const fileName = title.toString() || 'code';\n    if (content) {\n      const file = new Blob([content]);\n\n      const a = document.createElement('a');\n      const url = URL.createObjectURL(file);\n      a.href = url;\n      a.download = fileName;\n      document.body.appendChild(a);\n      a.click();\n      setTimeout(function () {\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n      }, 0);\n    }\n  }\n};\n","export const boxStyles: React.CSSProperties = {\n  width: '100%',\n  lineHeight: '16px',\n  whiteSpace: 'pre-wrap',\n  wordBreak: 'break-all',\n  backgroundColor: 'grayShade3',\n  fontWeight: 'text',\n  marginTop: 0,\n  marginBottom: 0,\n};\n\nexport const codeHeaderStyles = {\n  position: 'sticky',\n  top: 0,\n  zIndex: 1,\n  backgroundColor: 'grayShade2',\n  color: 'gray',\n  alignItems: 'center',\n  fontFamily: 'Inter',\n  fontWeight: 700,\n  fontSize: 'value',\n};\n\nexport const buttonsStyles = {\n  display: 'flex',\n  color: 'black',\n  fontFamily: 'Inter',\n  fontWeight: 700,\n  fontSize: '12px',\n  paddingTop: '2px',\n  paddingBottom: '3px',\n  paddingLeft: '8px',\n  paddingRight: '8px',\n  backgroundColor: 'grayShade2',\n  ':hover': {\n    backgroundColor: 'grayShade1',\n  },\n  ':active': {\n    backgroundColor: 'primaryShade1',\n  },\n  ':disabled': {\n    backgroundColor: 'primaryShade2',\n  },\n  borderLeftStyle: 'solid',\n  borderLeftWidth: 1,\n  borderLeftColor: 'grayShade1',\n  maxHeight: 23,\n  borderRadius: 0,\n  transition: 'all 0.8s cubic-bezier(0.19, 1, 0.22, 1)',\n};\n","import { EditorView } from '@codemirror/view';\nimport { useState } from 'react';\nimport { Box, Flex, FlexProps } from 'rebass';\n\nimport { LanguageName, loadLanguage } from '@uiw/codemirror-extensions-langs';\nimport { darcula } from '@uiw/codemirror-theme-darcula';\nimport CodeMirror from '@uiw/react-codemirror';\nimport { copyToClipboard, saveToFile } from '../../utils';\nimport { Button } from '../button';\nimport ExpandViewer from '../expand-viewer';\nimport { GetIcon, IconName } from '../icon';\nimport { PopupProps } from '../popup';\nimport Value from '../typography/value';\nimport { buttonsStyles, codeHeaderStyles } from './code.styles';\n\nconst CONTENT_UPPER_BOUND = 12;\n\nexport interface CodeProps extends Omit<FlexProps, 'css' | 'title'> {\n  title?: React.ReactElement | string;\n  content: string;\n  language?: LanguageName;\n  copyButton?: boolean;\n  downloadButton?: boolean;\n  downloadCallback?: () => void;\n  wrapLongLines?: boolean;\n  showLineNumbers?: boolean;\n  copyCallback?: () => Promise<boolean>;\n  expandable?: boolean;\n  popupProps?: Omit<PopupProps, 'children' | 'isOpen' | 'onClose'>;\n}\n\nexport const defaultPopupProps = {\n  size: '7xl',\n};\n\nconst Code = ({\n  content,\n  language,\n  copyButton = false,\n  downloadButton = false,\n  expandable = false,\n  popupProps = defaultPopupProps,\n  ...props\n}: CodeProps) => {\n  const contentLines = content.split('\\n');\n\n  // if it's expandable render it inside ExpandViewer\n  if (expandable && contentLines.length > CONTENT_UPPER_BOUND) {\n    return (\n      <ExpandViewer\n        title=\"Code snippet expanded view\"\n        /**\n         * currently merging with built-in javascript spread\n         * if we need deep merging we may use lodash merge function instead\n         */\n        popupProps={{ ...defaultPopupProps, ...popupProps }}\n        // eslint-disable-next-line react/no-unstable-nested-components\n        NormalComponent={() => (\n          <CodeSnippet\n            content={content}\n            language={language}\n            copyButton={copyButton}\n            downloadButton={downloadButton}\n            {...props}\n          />\n        )}\n        // eslint-disable-next-line react/no-unstable-nested-components\n        BriefComponent={() => (\n          <CodeSnippet\n            content={contentLines.slice(0, CONTENT_UPPER_BOUND).join('\\n')}\n            language={language}\n            copyButton={copyButton}\n            downloadButton={downloadButton}\n            {...props}\n          />\n        )}\n      />\n    );\n  }\n\n  // if it's not expandable then render it Normaly\n  return (\n    <CodeSnippet\n      content={content}\n      language={language}\n      copyButton={copyButton}\n      downloadButton={downloadButton}\n      {...props}\n    />\n  );\n};\n\nexport default Code;\n\n// Normal Code Component\ntype CodeSnippetProps = Omit<CodeProps, 'popupProps' | 'expandable'>;\nconst CodeSnippet = ({\n  title,\n  content,\n  language,\n  copyButton,\n  downloadButton,\n  downloadCallback,\n  wrapLongLines,\n  showLineNumbers,\n  copyCallback,\n  ...props\n}: CodeSnippetProps) => (\n  <Flex\n    flexDirection=\"column\"\n    width=\"100%\"\n    height=\"100%\"\n    sx={{ position: 'relative' }}\n  >\n    <Flex width=\"100%\" sx={codeHeaderStyles}>\n      <Box flexGrow={1} ml=\"8px\" my={1}>\n        {title}\n      </Box>\n      {downloadButton && (\n        <DownloadButton\n          content={content}\n          downloadCallback={downloadCallback}\n          title={title}\n        />\n      )}\n      {copyButton && (\n        <CopyButton content={content} copyCallback={copyCallback} />\n      )}\n    </Flex>\n    <Flex\n      width=\"100%\"\n      variant=\"code\"\n      sx={{\n        p: 0,\n        '*': { fontFamily: 'inherit' },\n      }}\n      {...props}\n    >\n      <CodeMirror\n        value={content}\n        basicSetup={{\n          autocompletion: false,\n          lineNumbers: showLineNumbers,\n          foldGutter: false,\n        }}\n        style={{\n          width: '100%',\n        }}\n        extensions={[EditorView.lineWrapping].concat(\n          language ? [loadLanguage(language)!].filter(Boolean) : [],\n        )}\n        theme={darcula}\n        readOnly\n      />\n    </Flex>\n  </Flex>\n);\n\n// Download Button\nconst DownloadButton = ({\n  content,\n  downloadCallback,\n  title,\n}: Pick<CodeProps, 'content' | 'downloadCallback' | 'title'>) => {\n  const download = () => {\n    if (downloadCallback) {\n      downloadCallback();\n    } else {\n      saveToFile(title || 'download', content);\n    }\n  };\n\n  return (\n    <Box>\n      <Button intent=\"ghost\" sx={buttonsStyles} onClick={download}>\n        <GetIcon size=\"md\" icon={IconName.download} />\n        <Value ml=\"5px\" mt=\"1px\">\n          download\n        </Value>\n      </Button>\n    </Box>\n  );\n};\n\n// Copy Button\nconst CopyButton = ({\n  copyCallback,\n  content,\n}: Pick<CodeProps, 'copyCallback' | 'content'>) => {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopyClicked = async () => {\n    let success = false;\n    if (copyCallback) {\n      success = await copyCallback();\n    } else {\n      await copyToClipboard(content);\n      success = true;\n    }\n    setCopied(success);\n    setTimeout(() => {\n      setCopied(false);\n    }, 800);\n  };\n\n  return (\n    <Box>\n      <Button\n        intent=\"ghost\"\n        sx={buttonsStyles}\n        onClick={handleCopyClicked}\n        disabled={copied}\n      >\n        <GetIcon size=\"md\" icon={IconName.copy} />\n        <Value ml=\"5px\" mt=\"1px\">\n          {copied ? 'copied' : 'copy'}\n        </Value>\n      </Button>\n    </Box>\n  );\n};\n"],"names":["copyToClipboard","content","textArea","error","saveToFile","title","fileName","file","a","url","codeHeaderStyles","buttonsStyles","CONTENT_UPPER_BOUND","defaultPopupProps","Code","language","copyButton","downloadButton","expandable","popupProps","props","contentLines","jsx","ExpandViewer","CodeSnippet","downloadCallback","wrapLongLines","showLineNumbers","copyCallback","jsxs","Flex","Box","DownloadButton","CopyButton","CodeMirror","EditorView","loadLanguage","darcula","download","Button","GetIcon","IconName","Value","copied","setCopied","useState","handleCopyClicked","success"],"mappings":"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"}